"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkcnapx_trials"] = self["webpackChunkcnapx_trials"] || []).push([["src_main_qr_code_payment_ui_js"],{

/***/ "./src/main/qr_code_payment_ui.js":
/*!****************************************!*\
  !*** ./src/main/qr_code_payment_ui.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   QRCodePaymentUi: () => (/* binding */ QRCodePaymentUi)\n/* harmony export */ });\n/* harmony import */ var _utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/insert_into_DOM.js */ \"./src/utils/insert_into_DOM.js\");\n/* harmony import */ var _utils_toast_it_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/toast_it.js */ \"./src/utils/toast_it.js\");\n\r\n\r\n\r\nclass QRCodePaymentUi \r\n{\r\n    #_mErrors;\r\n    #mErrorMsg;\r\n    constructor() \r\n    {\r\n        this.#_mErrors = 0;\r\n        this.#mErrorMsg = '';\r\n\r\n    }\r\n\r\n    /**\r\n     * Class public API\r\n     */\r\n    createUi()\r\n    {\r\n        if(this.#_mErrors == 0)\r\n        {\r\n            let content = `\r\n            <div class=\"container\">\r\n                <div class=\"row\" style=\"margin-top: 3rem;\">\r\n                    <div class=\"col s12 hide-on-med-and-up center-align\">\r\n                        <img src=\"./images/userprofile.png\" alt=\"\">\r\n                        <br>\r\n                        <small class=\"blue-text text-darken-3\">\r\n                            <b> \r\n                                <a href=\"#\" class=\"sidenav-trigger\" data-target=\"mobile-demo\">\r\n                                    John Danfodio\r\n                                </a>\r\n                            </b>\r\n                        </small>\r\n                    </div>\r\n\r\n                    <div class=\"col s12 hide-on-small-only\">\r\n                        <img src=\"./images/userprofile.png\" alt=\"\">\r\n                        <br>\r\n                        <small class=\"blue-text text-darken-3\">\r\n                            <b>\r\n                                <a href=\"#\" class=\"sidenav-trigger\" data-target=\"mobile-demo\">\r\n                                    John Danfodio\r\n                                </a>\r\n                            </b>\r\n                        </small>\r\n                    </div>\r\n\r\n                    <!--  PAGE TITLE-->\r\n                    <div class=\"col s12 center-align\" id=\"pageTitle\" style=\"margin-bottom: 2rem;\">\r\n                        \r\n                    </div>\r\n\r\n                    <!--BOX-1 (INSTRUCTION DEFAULT)-->\r\n                    <div class=\"col s12 m4 l4\" id=\"boxOne\">\r\n                    </div>\r\n\r\n                    <div class=\"col s12 m4 l4\" id=\"boxTwo\">\r\n                    </div>\r\n\r\n                    <div class=\"col s12 m4 l4\" id=\"boxThree\">\r\n                    </div>\r\n\r\n\r\n                    <div class=\"col s12 right-align\" style=\"margin-top: 6rem;\">\r\n                        <p>\r\n                            <div class=\"divider\"></div>\r\n                        </p>\r\n                        <small class=\"grey-text\"> Powered by </small>\r\n                        <b class=\"purple-text text-darken-3\">iservng</b>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            `;\r\n\r\n            (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('main', content);\r\n\r\n            this.#loadPageComponents();\r\n            this.#registerCancelEventHandler();\r\n            //\r\n\r\n\r\n\r\n        }\r\n        else \r\n        {\r\n            (0,_utils_toast_it_js__WEBPACK_IMPORTED_MODULE_1__.toastIt)('red', this.#mErrorMsg);\r\n            console.log(this.#mErrorMsg);\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    /**\r\n     * Utility class function for ui manipulation\r\n     */\r\n    #showQRCode()\r\n    {\r\n\r\n        //Hide box 1 and 2\r\n        this.#hideBoxOne();\r\n        this.#hideBoxThree();\r\n        \r\n        let content = `\r\n        <div class=\"row\">\r\n            <div class=\"col s12\">\r\n                <div class=\"card z-depth-0\">\r\n                    <div class=\"card-content center-align\">\r\n\r\n                        <span class=\"card-title\">\r\n                            <strong class=\"purple-text\" id=\"cardTitle\">\r\n                                Generating code!\r\n                            </strong>\r\n                        </span>\r\n                        <p style=\"margin-top: 2rem;\" id=\"qrcodeImgContainer\">\r\n                            <img src=\"./images/qr.png\" alt=\"qrcode\" width=\"200\" height=\"200\" id=\"qrcodeImg\">\r\n                        </p>\r\n                        \r\n                    </div>\r\n                    <div class=\"card-action\">\r\n                        <a href=\"#\" class=\"cancel\">\r\n                            Cancel\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        `;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#boxTwo', content);\r\n\r\n\r\n        /**\r\n         * The qr-image interface has been load successly, \r\n         * we, can then \r\n         */\r\n        // -------------------------\r\n        if(document.querySelector('#qrcodeImg'))\r\n        {\r\n            document.querySelector('#qrcodeImgContainer').innerHTML = `\r\n            <progress></progress>\r\n            <br>\r\n            <small class=\"purple-text\"><i>Generating... please wait</i>!</small>\r\n            `;\r\n            let dataForQR = \"2click@cnapxpaytt\";\r\n            this.#serverGeneratQRCode(dataForQR);\r\n            \r\n        }\r\n        \r\n\r\n        //Call the page title to specify what is happening\r\n        // this.#hidePageTitle();\r\n        this.#registerCancelEventHandler();\r\n    }\r\n    #serverGeneratQRCode(data)\r\n    {\r\n        let qrValue = data;\r\n        let imgURL = ``;\r\n        imgURL = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${qrValue}`;\r\n\r\n        let qrImg = document.createElement('img');\r\n        qrImg.src = imgURL;\r\n        \r\n        qrImg.addEventListener('load', () => {\r\n\r\n            document.querySelector('strong#cardTitle').innerHTML = 'Pay Now';\r\n            let qrcodeImgContainer = document.querySelector('#qrcodeImgContainer');\r\n            qrcodeImgContainer.innerHTML = ``;\r\n            qrcodeImgContainer.append(qrImg);\r\n            \r\n\r\n        });\r\n        // -------------------------\r\n        // SET TIME OUT FOR A DEFAULT QR-IMAGE \r\n        // -------------------------------------\r\n\r\n        \r\n        setTimeout(this.#checkTitleChanges, 3000);\r\n       \r\n\r\n    }\r\n    #checkTitleChanges()\r\n    {\r\n        // console.log(\"Title change checker ok\");\r\n        let title = document.querySelector('strong#cardTitle').innerHTML.trim();\r\n        if(title === 'Generating code!')\r\n        {\r\n            (0,_utils_toast_it_js__WEBPACK_IMPORTED_MODULE_1__.toastIt)('blue', \"Scan code to pay!\");\r\n            let qrImg = document.createElement('img');\r\n            qrImg.src = \"./images/qr.png\";\r\n\r\n            document.querySelector('strong#cardTitle').innerHTML = 'Pay Now';\r\n            let qrcodeImgContainer = document.querySelector('#qrcodeImgContainer');\r\n            qrcodeImgContainer.innerHTML = ``;\r\n            qrcodeImgContainer.append(qrImg);\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    //Show Page Title.\r\n    // -----------------\r\n    #showPageTitle(title)\r\n    {\r\n\r\n        let content = `\r\n        <small class=\"purple-text text-darken-3\">\r\n            <p>\r\n                <h6><b>${title}</b></h6>\r\n            </p>\r\n        </small>\r\n        `;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#pageTitle', content);\r\n\r\n    }\r\n    #hidePageTitle()\r\n    {\r\n        let content = `&nbsp;`;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#pageTitle', content);\r\n\r\n    }\r\n\r\n\r\n    //1. BoxOne\r\n    //Show Page Instruction in Box-1\r\n    #showBoxOne()\r\n    {\r\n        let content = `\r\n            <div class=\"row\">\r\n                <div class=\"card-panel white z-depth-0\">\r\n                    <b class=\"purple-text text-darken-2\">\r\n                        Please Confirm.\r\n                    </b>\r\n                    <p>\r\n                        <small class=\"grey-text text-darken-2\">\r\n                            Please specify either to open the scan for recieving payment or show the QR-Code to be scanned.\r\n                        </small>\r\n                    </p>\r\n                    <p>\r\n                        <a href=\"#\" class=\"red-text cancel\">\r\n                            cancel\r\n                        </a>\r\n                    </p>\r\n                                    \r\n                </div>        \r\n            </div>\r\n        `;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#boxOne', content);\r\n    }\r\n\r\n    #hideBoxOne()\r\n    {\r\n\r\n        let content = `&nbsp;`;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#boxOne', content);\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    //2. BoxTwo\r\n    //Show the btn for qr\r\n    #showBoxTwo()\r\n    {\r\n        let content = `\r\n            <div class=\"card-panel purple lighten-5 z-depth-0\" style=\"border-bottom: 1px solid purple; border-top: 1px solid purple;\">\r\n                <div class=\"white-text center-align\">\r\n                    <b>\r\n                        <a href=\"#\" id=\"ShowQRCode\" class=\"btn-small purple darken-4\">\r\n                            Pay Now\r\n                        </a>\r\n                    </b>      \r\n                </div>\r\n            </div>\r\n        `;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#boxTwo', content);\r\n\r\n        /**\r\n             * Register an event handler for the show ShowQRCode button above\r\n             */\r\n        if(document.querySelector('#ShowQRCode'))\r\n        {\r\n            document.querySelector('#ShowQRCode').addEventListener('click', e => {\r\n                e.preventDefault();\r\n                this.#showQRCode();\r\n            });\r\n        }\r\n    }\r\n    #hideBoxTwo()\r\n    {\r\n\r\n        let content = '&nbsp;';\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#boxTwo', content);\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    //3. BoxThree\r\n    //Contains the scanner\r\n    #showBoxThree()\r\n    {\r\n        console.log(\"Na box three\");\r\n        let content = `\r\n        <div class=\"card-panel purple lighten-5 z-depth-0\" style=\"border-bottom: 1px solid purple; border-top: 1px solid purple;\">\r\n            <div class=\"white-text center-align\">\r\n                <b>\r\n                    <a href=\"#\" class=\"btn-small purple darken-4 text-darken-3 collectByScanner\">\r\n                        Collect\r\n                    </a>\r\n                </b>         \r\n            </div>\r\n        </div>\r\n        `;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#boxThree', content);\r\n\r\n        if(document.querySelector('.collectByScanner'))\r\n        {\r\n            document.querySelector('.collectByScanner').addEventListener('click', e => {\r\n                e.preventDefault();\r\n                this.#showScannerUi();\r\n            })\r\n        }\r\n        // --------------------\r\n    }\r\n    #showScannerUi()\r\n    {\r\n    \r\n        this.#hideBoxOne();\r\n        this.#hideBoxThree();\r\n        // this.#hidePageTitle();\r\n\r\n        let content = `\r\n        <div class=\"row\">\r\n            <div class=\"col s12\">\r\n                <div class=\"card z-depth-0\">\r\n                    <div class=\"card-content purple-text center-align\" style=\"overflow: hidden;\">\r\n                        <span class=\"card-title\">\r\n                            <strong id=\"scannerTitle\">Getting Scanner</strong>\r\n                        </span>\r\n                        \r\n                        <p style=\"margin-top: 2rem; overflow: hidden;\" id=\"scannerContainer\">\r\n                            <progress></progress>\r\n                        </p>\r\n                        <div class=\"video-container\">\r\n                            <video class=\"responsive-video\"></video>\r\n                        </div>\r\n                        \r\n                    </div>\r\n                    <div class=\"card-action\">\r\n                        <a href=\"#\" class=\"btn-small red stopCam\">Stop</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        `;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#boxTwo', content);\r\n\r\n        //Call the user-device camera to start scan\r\n        let video = document.querySelector('video');\r\n        // let textarea = document.querySelector('textarea');\r\n\r\n        this.#startUserCameraScan(video);\r\n\r\n\r\n        //Register Event-Handler for the cancel btn, which actualy takes a user back to the payment-profile-dashboard\r\n        this.#registerCancelEventHandler();\r\n\r\n    }\r\n    \r\n    #startUserCameraScan(video)\r\n    {\r\n        \r\n        // Scan QR Code using Device Camera\r\n        let scanner;\r\n        scanner = new Instascan.Scanner({video: video});\r\n\r\n            Instascan.Camera.getCameras()\r\n            .then(cameras => {\r\n\r\n                if(cameras.length > 0)\r\n                {\r\n                    scanner.start(cameras[0])\r\n                    .then(() => {\r\n                        // form.classList.add('active-video');\r\n                        // stopCam.style.display = \"inline-block\";\r\n                    })\r\n                }\r\n                else \r\n                {\r\n                    console.log(\"No Camera Found!\");\r\n                    (0,_utils_toast_it_js__WEBPACK_IMPORTED_MODULE_1__.toastIt)('red', 'No Camera found');\r\n                }\r\n\r\n            })\r\n            .catch(error => {\r\n                console.log(error.massage);\r\n            });\r\n\r\n            \r\n            scanner.addListener('scan', c => {\r\n\r\n                document.querySelector('#scannerContainer').innerHTML = ``;\r\n                document.querySelector('#scannerTitle').innerHTML = `<span class=\"green-text\">&#10003;<br>Done!</span>`;\r\n                console.log(c);\r\n                /**\r\n                 * a====================\r\n                 * After the secret-text has been decoded by the scanner, it is now we call \r\n                 * 1. The interface to hide the scanner-ui, \r\n                 * 2. Proceed with what is next in line of processing.\r\n                 */\r\n                // ================================\r\n            });\r\n        // -----------------------------\r\n        \r\n        //Register event handler for\r\n        if(document.querySelector('.stopCam')) \r\n        {\r\n            document.querySelector('.stopCam').addEventListener('click', e => {\r\n                e.preventDefault();\r\n                this.#stopCam(scanner);\r\n            });\r\n        }\r\n\r\n    }\r\n    #stopCam(scanner)\r\n    {\r\n        \r\n        if(scanner) scanner.stop();\r\n\r\n        //After the scan is stopped rebuils the ui\r\n        this.#showBoxOne();\r\n        this.#showBoxTwo();\r\n        this.#showBoxThree();\r\n\r\n\r\n    }\r\n    #hideBoxThree()\r\n    {\r\n\r\n        let content = `&nbsp;`;\r\n        (0,_utils_insert_into_DOM_js__WEBPACK_IMPORTED_MODULE_0__.insertIntoDOM)('#boxThree', content);\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    /**\r\n     * This function provide the initial values (state) at the start of this interface. \r\n     */\r\n    #loadPageComponents()\r\n    {\r\n\r\n        let title = \"Generate or Scan QR-Code\";\r\n        this.#showPageTitle(title);\r\n\r\n        this.#showBoxOne();\r\n        this.#showBoxTwo();\r\n        this.#showBoxThree();\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    #registerCancelEventHandler()\r\n    {\r\n        /**\r\n             * 1. CANCEL\r\n             * ----------\r\n             * Register event handler for the cancel-button that returns user to the dashboard ui.\r\n             */\r\n        if(document.querySelectorAll('.cancel'))\r\n        {\r\n            \r\n            let cancelBtns = document.querySelectorAll('.cancel');\r\n            cancelBtns.forEach(cancel => {\r\n                cancel.addEventListener('click', e => {\r\n                    e.preventDefault();\r\n\r\n                    __webpack_require__.e(/*! import() */ \"src_main_marchant_customer_profile_dashboard_js\").then(__webpack_require__.bind(__webpack_require__, /*! ./marchant_customer_profile_dashboard.js */ \"./src/main/marchant_customer_profile_dashboard.js\"))\r\n                    .then(m => {\r\n                        let dashboard = new m.CustomerProfileDashboard();\r\n                        dashboard.createUi();\r\n                    })\r\n                    .catch(error => {\r\n                        console.log(error.message);\r\n                        (0,_utils_toast_it_js__WEBPACK_IMPORTED_MODULE_1__.toastIt)('red', 'Error! Unable to load UI.');\r\n                    });\r\n                    // -----------\r\n\r\n                });\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n\r\n\n\n//# sourceURL=webpack://cnapx-trials/./src/main/qr_code_payment_ui.js?");

/***/ })

}]);